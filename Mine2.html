<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, orientation=landscape">
    <title>Steve Parkour PRO</title>
    <style>
        body { margin: 0; overflow: hidden; background: #87CEEB; font-family: 'Segoe UI', bold; touch-action: none; }
        canvas { display: block; }
        #ui { position: absolute; top: 10px; left: 10px; color: white; text-shadow: 2px 2px 0px #000; pointer-events: none; z-index: 10; }
        #fs-btn { position: absolute; top: 10px; right: 10px; padding: 10px; background: rgba(0,0,0,0.5); color: white; border: 2px solid white; border-radius: 5px; cursor: pointer; z-index: 30; }
        .controls { position: absolute; bottom: 20px; width: 100%; display: flex; justify-content: space-between; padding: 0 40px; box-sizing: border-box; z-index: 20; }
        .btn { width: 85px; height: 85px; background: rgba(0,0,0,0.5); border: 4px solid #fff; border-radius: 15px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 18px; user-select: none; }
    </style>
</head>
<body>
    <div id="ui">
        <h2 id="levelText">NÍVEL: 1</h2>
        <small>Toque no ouro para avançar</small>
    </div>
    
    <button id="fs-btn">TELA CHEIA</button>

    <div class="controls">
        <div style="display: flex; gap: 20px;">
            <div class="btn" id="btnLeft">ESQ</div>
            <div class="btn" id="btnRight">DIR</div>
        </div>
        <div class="btn" id="btnJump">PULAR</div>
    </div>

<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const fsBtn = document.getElementById("fs-btn");

function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
window.onresize = resize;
resize();

// Tela Cheia
fsBtn.onclick = () => {
    if (!document.fullscreenElement) canvas.parentElement.requestFullscreen();
    else document.exitFullscreen();
};

const gridSize = 50;
const gravity = 0.6;
let currentLevel = 1;
let world = {};
let cameraX = 0;

const player = { x: 50, y: 300, w: 32, h: 56, vx: 0, vy: 0, speed: 6, jump: -14, onGround: false, dir: 1 };

function generateLevel(lvl) {
    world = {};
    cameraX = 0;
    player.x = 50; player.y = 300;
    
    // Plataforma Inicial
    for(let i=0; i<4; i++) world[`${i*gridSize},${500}`] = "grass";

    let lastX = 200;
    let lastY = 500;
    const steps = 8 + (lvl * 2);

    for(let i = 0; i < steps; i++) {
        lastX += 130 + Math.random() * 60;
        lastY += (Math.random() - 0.5) * 180;
        lastY = Math.max(200, Math.min(canvas.height - 100, lastY));
        
        let gx = Math.floor(lastX/gridSize)*gridSize;
        let gy = Math.floor(lastY/gridSize)*gridSize;
        world[`${gx},${gy}`] = (i === steps - 1) ? "gold" : (Math.random() > 0.5 ? "stone" : "dirt");
    }
}

const input = { left: false, right: false, jump: false };
const setupBtn = (id, key) => {
    const el = document.getElementById(id);
    el.ontouchstart = (e) => { e.preventDefault(); input[key] = true; };
    el.ontouchend = (e) => { e.preventDefault(); input[key] = false; };
};
setupBtn("btnLeft", "left"); setupBtn("btnRight", "right"); setupBtn("btnJump", "jump");

function drawSteve(x, y) {
    let sx = x - cameraX;
    ctx.save();
    
    // Efeito de balanço ao andar
    if(Math.abs(player.vx) > 0.1) {
        ctx.translate(sx + 16, y + 28);
        ctx.rotate(Math.sin(Date.now() * 0.01) * 0.05);
        ctx.translate(-(sx + 16), -(y + 28));
    }

    // Pernas
    ctx.fillStyle = "#3c44aa"; 
    ctx.fillRect(sx + 4, y + 36, 24, 20); 
    // Corpo
    ctx.fillStyle = "#3aa0a0"; 
    ctx.fillRect(sx + 4, y + 12, 24, 24);
    // Braços
    ctx.fillStyle = "#d3a395";
    ctx.fillRect(sx - 2, y + 12, 6, 20); // Braço esquerdo
    ctx.fillRect(sx + 28, y + 12, 6, 20); // Braço direito
    // Cabeça
    ctx.fillStyle = "#d3a395"; 
    ctx.fillRect(sx + 4, y - 10, 24, 22);
    // Cabelo e Barba
    ctx.fillStyle = "#553311";
    ctx.fillRect(sx + 4, y - 10, 24, 6); // Cabelo
    ctx.fillRect(sx + 10, y + 6, 12, 4); // Barba
    // Olhos
    ctx.fillStyle = "white";
    ctx.fillRect(sx + 6, y, 4, 4); ctx.fillRect(sx + 22, y, 4, 4);
    ctx.fillStyle = "#4444aa";
    ctx.fillRect(sx + 7, y + 1, 2, 2); ctx.fillRect(sx + 23, y + 1, 2, 2);
    
    ctx.restore();
}

function drawBlock(x, y, type) {
    let sx = x - cameraX;
    if(type === "grass") {
        ctx.
