<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, orientation=landscape">
    <title>Beast Parkour Ultra HD - Admin Edition</title>
    <style>
        body { margin: 0; overflow: hidden; background: #4a90e2; font-family: 'Segoe UI', Arial, sans-serif; touch-action: none; }
        canvas { display: block; image-rendering: pixelated; }
        #menu, #deathMenu, #shopMenu, #adminPanel { 
            position: absolute; inset: 0; background: rgba(10, 20, 30, 0.95);
            backdrop-filter: blur(15px); display: flex; flex-direction: column; 
            align-items: center; justify-content: center; z-index: 200; text-align: center; color: white;
        }
        #deathMenu, #shopMenu, #adminPanel { display: none; }
        #adminPanel { border: 5px solid #ff4444; }
        .btn { width: 280px; padding: 16px; margin: 8px; font-size: 16px; font-weight: bold; color: white; border: none; border-radius: 8px; cursor: pointer; transition: 0.2s; box-shadow: 0 5px #000; text-transform: uppercase; }
        .btn-start { background: #44dd44; }
        .btn-shop { background: #bb44bb; }
        .btn-menu { background: #555; }
        .btn-admin { background: #ff4444; }
        .btn:active { transform: translateY(4px); box-shadow: 0 1px #000; }
        
        #ui { position: absolute; top: 15px; left: 15px; background: rgba(0,0,0,0.85); color: #00ff00; padding: 12px; border-radius: 5px; z-index: 100; border-left: 5px solid #00ff00; cursor: pointer; font-family: monospace; }
        #abilityHUD { position: absolute; top: 15px; right: 15px; width: 200px; height: 45px; background: rgba(0,0,0,0.8); border: 2px solid #fff; border-radius: 8px; z-index: 100; overflow: hidden; }
        #abilityFill { position: absolute; left: 0; height: 100%; width: 100%; background: #00e5ff; transition: width 0.1s; }
        #abilityText { position: relative; width: 100%; text-align: center; line-height: 45px; font-weight: bold; font-size: 14px; text-shadow: 1px 1px #000; }

        .controls { position: absolute; bottom: 30px; width: 100%; display: flex; justify-content: space-between; padding: 0 50px; box-sizing: border-box; pointer-events: none; }
        .ctrl-btn { width: 85px; height: 85px; background: rgba(255,255,255,0.15); border: 2px solid #fff; border-radius: 50%; pointer-events: auto; display: flex; align-items: center; justify-content: center; font-size: 35px; color: white; backdrop-filter: blur(5px); }
    </style>
</head>
<body>

    <div id="ui" onclick="checkAdmin()">D: <span id="dist">0</span>m | üíé <span id="coins">0</span></div>
    
    <div id="abilityHUD">
        <div id="abilityFill"></div>
        <div id="abilityText">HABILIDADE</div>
    </div>

    <div id="adminPanel">
        <h1 style="color: #ff4444; margin-bottom: 20px;">TERMINAL ADMINISTRATIVO</h1>
        <button class="btn btn-admin" onclick="toggleGod()">MODO GOD: <span id="godTxt">OFF</span></button>
        <button class="btn" style="background: #ff8800;" onclick="toggleSpeed()">SUPER VELOCIDADE: <span id="spdTxt">OFF</span></button>
        <button class="btn" style="background: #ffcc00; color: #000;" onclick="coins += 10000; save(); alert('10k Gemas Adicionadas!');">+10.000 GEMAS</button>
        <button class="btn btn-menu" onclick="document.getElementById('adminPanel').style.display='none'">SAIR DO PAINEL</button>
    </div>

    <div id="menu">
        <h1 style="font-size: 45px; text-shadow: 4px 4px #000;">BEAST PARKOUR 3.0</h1>
        <button class="btn btn-start" onclick="startGame(true)">INICIAR DESAFIO</button>
        <button class="btn btn-shop" onclick="openShop()">LOJA DE SKINS</button>
    </div>

    <div id="shopMenu">
        <h1>SELECIONE SEU AVATAR</h1>
        <div style="display: flex; gap: 15px; margin-bottom: 25px; flex-wrap: wrap; justify-content: center;">
            <button class="btn" style="background: #3a81a7; width: 130px;" onclick="selectSkin('steve')">STEVE</button>
            <button class="btn" style="background: #00a8ff; width: 130px;" onclick="selectSkin('mrbeast')">MRBEAST</button>
            <button class="btn" style="background: #222; width: 130px;" onclick="selectSkin('herobrine')">HEROBRINE</button>
        </div>
        <button class="btn btn-menu" onclick="document.getElementById('shopMenu').style.display='none'">FECHAR LOJA</button>
    </div>

    <div id="deathMenu">
        <h1 style="color:#ff4444; font-size: 45px;">GAME OVER</h1>
        <button class="btn btn-start" id="respawnBtn" onclick="startGame(false)">VOLTAR CHECKPOINT</button>
        <button class="btn btn-menu" onclick="location.reload()">MENU INICIAL</button>
    </div>

    <div class="controls" id="gameControls" style="display:none;">
        <div style="display:flex; gap:25px; pointer-events:auto;">
            <div class="ctrl-btn" id="left">‚Üê</div>
            <div class="ctrl-btn" id="right">‚Üí</div>
        </div>
        <div style="display:flex; gap:25px; pointer-events:auto;">
            <div class="ctrl-btn" style="border-color:#00e5ff; color:#00e5ff" id="power">W</div>
            <div class="ctrl-btn" id="jump">‚Üë</div>
        </div>
    </div>

    <canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
let gameActive = false, world = {}, cameraX = 0, lastX = 0, adminClicks = 0;
let coins = parseInt(localStorage.getItem("coins")) || 0;
let currentSkin = localStorage.getItem("skin") || "steve";
let godMode = false, superSpeed = false;

// Regras de Checkpoint e Poderes
let nextCP = 80;
let checkpointPos = { x: 100, y: 100 };
let hasCP = false;
let lastPowerDist = -200; 

const player = { x: 100, y: 100, vx: 0, vy: 0, w: 35, h: 65, ground: false, jumps: 0 };
const keys = { left: false, right: false };

function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
window.addEventListener('resize', resize); resize();
function save() { localStorage.setItem("coins", coins); localStorage.setItem("skin", currentSkin); }

// Fun√ß√µes Admin
function checkAdmin() { adminClicks++; if(adminClicks >= 5) { adminClicks = 0; document.getElementById('adminPanel').style.display='flex'; } }
function toggleGod() { godMode = !godMode; document.getElementById('godTxt').innerText = godMode ? "ON" : "OFF"; }
function toggleSpeed() { superSpeed = !superSpeed; document.getElementById('spdTxt').innerText = superSpeed ? "ON" : "OFF"; }
function selectSkin(s) { currentSkin = s; save(); document.getElementById('shopMenu').style.display='none'; }
function openShop() { document.getElementById('shopMenu').style.display='flex'; }

function startGame(fullReset) {
    document.getElementById("menu").style.display = "none";
    document.getElementById("deathMenu").style.display = "none";
    document.getElementById("gameControls").style.display = "flex";
    if(fullReset) {
        world = {}; player.x = 100; player.y = 100; nextCP = 80; hasCP = false; lastPowerDist = -200;
        for(let i=0; i<15; i++) world[`${i*50},${Math.floor(canvas.height*0.75/50)*50}`] = "grass";
    } else {
        player.x = checkpointPos.x; player.y = checkpointPos.y;
    }
    player.vx = 0; player.vy = 0; gameActive = true; loop();
}

function usePowerW() {
    let d = Math.floor(player.x / 50);
    if(currentSkin === 'herobrine' && (d - lastPowerDist) >= 150) {
        for(let i=1; i<=9; i++) {
            let bx = Math.floor((player.x + i*50)/50)*50;
            let by = Math.floor((player.y + 65)/50)*50;
            world[`${bx},${by}`] = "magic";
        }
        lastPowerDist = d;
    }
}

function jumpAction() {
    let d = Math.floor(player.x / 50);
    if(player.ground || godMode) { 
        player.vy = -17; 
        player.jumps = 1; 
    } 
    else if(currentSkin === 'mrbeast' && player.jumps === 1 && (d - lastPowerDist) >= 200) { 
        player.vy = -16; 
        player.jumps = 2; 
        lastPowerDist = d;
    }
}

function drawSkin(x, y) {
    // Pernas e Bra√ßos
    ctx.fillStyle = currentSkin === 'mrbeast' ? "#0077cc" : (currentSkin === 'herobrine' ? "#111" : "#2a6187");
    ctx.fillRect(x - 2, y + 45, 12, 20); // Perna Esq
    ctx.fillRect(x + 20, y + 45, 12, 20); // Perna Dir
    
    // Corpo (Camisa)
    ctx.fillStyle = currentSkin === 'mrbeast' ? "#00a8ff" : (currentSkin === 'herobrine' ? "#333" : "#3a81a7");
    ctx.fillRect(x, y + 20, 30, 30);
    
    // Detalhe de Cinto/Fivela
    ctx.fillStyle = "#222"; ctx.fillRect(x, y+45, 30, 4);

    // Cabe√ßa
    ctx.fillStyle = "#ffdbac"; ctx.fillRect(x + 5, y, 20, 20);
    
    // Cabelo HD
    ctx.fillStyle = currentSkin === 'mrbeast' ? "#4e342e" : "#5d4037";
    ctx.fillRect(x + 5, y, 20, 6);
    ctx.fillRect(x + 22, y, 3, 10); // Lado do cabelo

    // Olhos
    if(currentSkin === 'herobrine') { 
        ctx.fillStyle = "white"; 
        ctx.shadowBlur = 15; ctx.shadowColor = "#00e5ff"; 
    } else { ctx.fillStyle = "black"; }
    ctx.fillRect(x + 8, y + 9, 4, 4); ctx.fillRect(x + 18, y + 9, 4, 4);
    ctx.shadowBlur = 0;
}

function loop() {
    if(!gameActive) return;
    let d = Math.floor(player.x / 50);

    // Barra de Poder
    let cdTarget = currentSkin === 'mrbeast' ? 200 : 150;
    let diff = d - lastPowerDist;
    let progress = Math.min(1, diff / cdTarget);
    let faltam = Math.max(0, cdTarget - diff);
    document.getElementById("abilityFill").style.width = (progress * 100) + "%";
    document.getElementById("abilityFill").style.background = progress >= 1 ? "#00ff00" : "#ffcc00";
    document.getElementById("abilityText").innerText = currentSkin === 'steve' ? "SEM PODER" : (progress >= 1 ? "PRONTO!" : `FALTAM: ${faltam}m`);

    // F√≠sica e Movimento
    let speedMult = superSpeed ? 14 : 7.5;
    if(keys.left) player.vx = -speedMult; else if(keys.right) player.vx = speedMult; else player.vx *= 0.8;
    
    // Se Modo God: Voa livremente sem gravidade
    if(godMode) {
        player.vy *= 0.8; // Suaviza parada
    } else {
        player.vy += 0.85; // Gravidade normal
    }
    
    player.x += player.vx;
    player.y += player.vy;

    // Colis√µes e Regras de Checkpoint
    player.ground = false;
    for(let pos in world) {
        let [bx, by] = pos.split(",").map(Number);
        if(player.x + 25 > bx && player.x < bx + 45 && player.y + 65 >= by && player.y + 65 <= by + 20) {
            if(player.vy >= 0) { 
                player.y = by - 65; 
                player.vy = 0; 
                player.ground = true; 
                player.jumps = 0;

                // Checkpoint R√≠gido: 80m, 180m, 280m...
                if(d >= nextCP) {
                    checkpointPos = { x: player.x, y: player.y };
                    hasCP = true;
                    let r = Math.random() * 100;
                    if(r <= 5) coins += 8; else if(r <= 25) coins += 4; else if(r <= 80) coins += 1;
                    save();
                    nextCP += 100;
                }
            }
        }
    }

    // Gerador
    if(player.x > lastX - 1300) {
        let bx = Math.floor((lastX + 250)/50)*50;
        let by = Math.floor((canvas.height * 0.7)/50)*50 + (Math.random()*150 - 75);
        world[`${bx},${by}`] = "grass"; 
        world[`${bx+50},${by}`] = "grass"; 
        lastX = bx + 100;
    }

    cameraX += (player.x - canvas.width/3 - cameraX) * 0.1;
    ctx.fillStyle = "#87ceeb"; ctx.fillRect(0,0,canvas.width, canvas.height);

    for(let pos in world) {
        let [bx, by] = pos.split(",").map(Number);
        ctx.fillStyle = world[pos] === "magic" ? "#fff" : "#43a047";
        ctx.fillRect(bx - cameraX, by, 50, 12);
        ctx.fillStyle = "#6d4c41"; ctx.fillRect(bx - cameraX, by+12, 50, 40);
    }

    drawSkin(player.x - cameraX, player.y);

    if(player.y > canvas.height + 200 && !godMode) { 
        gameActive = false; 
        document.getElementById("deathMenu").style.display = "flex";
        document.getElementById("respawnBtn").innerText = hasCP ? "VOLTAR CHECKPOINT" : "RECOME√áAR";
    }
    
    document.getElementById("dist").innerText = d;
    document.getElementById("coins").innerText = coins;
    requestAnimationFrame(loop);
}

// Eventos
document.getElementById("jump").ontouchstart = (e) => { e.preventDefault(); jumpAction(); };
document.getElementById("power").ontouchstart = (e) => { e.preventDefault(); usePowerW(); };
document.getElementById("left").ontouchstart = (e) => { e.preventDefault(); keys.left = true; };
document.getElementById("left").ontouchend = () => keys.left = false;
document.getElementById("right").ontouchstart = (e) => { e.preventDefault(); keys.right = true; };
document.getElementById("right").ontouchend = () => keys.right = false;

window.onkeydown = (e) => {
    if(e.key === " ") jumpAction();
    if(e.key === "ArrowLeft") keys.left = true;
    if(e.key === "ArrowRight") keys.right = true;
    if(e.key === "ArrowUp" && godMode) player.vy = -10; // Voar no God Mode
    if(e.key.toLowerCase() === "w") usePowerW();
};
window.onkeyup = (e) => { if(e.key === "ArrowLeft") keys.left = false; if(e.key === "ArrowRight") keys.right = false; };
</script>
</body>
</html>
