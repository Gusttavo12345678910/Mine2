<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, orientation=landscape">
    <title>Steve Parkour - Classic Size</title>
    <style>
        body { margin: 0; overflow: hidden; background: #9db9eb; font-family: 'Arial', sans-serif; touch-action: none; }
        canvas { display: block; }
        
        #menu {
            position: absolute; width: 100%; height: 100%;
            background: linear-gradient(rgba(135, 206, 235, 0.6), rgba(157, 185, 235, 0.8));
            display: flex; flex-direction: column; align-items: center; justify-content: space-between;
            z-index: 200; padding: 40px 0; box-sizing: border-box;
        }
        .menu-btn {
            width: 280px; padding: 18px;
            background: #4caf50; border: none; border-bottom: 6px solid #2e7d32;
            border-radius: 8px; font-size: 22px; font-weight: bold; color: white;
            cursor: pointer; text-align: center; text-shadow: 2px 2px 0px rgba(0,0,0,0.3);
            transition: 0.1s; z-index: 210;
        }
        .menu-btn.blue { background: #2196f3; border-bottom: 6px solid #1565c0; }
        .menu-btn:active { transform: translateY(4px); border-bottom-width: 2px; }
        
        h1 { color: #fff; text-shadow: 4px 4px 0 #333; font-size: 50px; margin: 0; z-index: 210; }
        #highScoreText { color: #fff; font-size: 18px; background: rgba(0,0,0,0.5); padding: 8px 20px; border-radius: 20px; z-index: 210; }

        #ui { position: absolute; top: 10px; left: 10px; background: rgba(255,255,255,0.95); padding: 12px; border-radius: 5px; border: 2px solid #333; z-index: 10; display: none; }
        .controls { position: absolute; bottom: 20px; width: 100%; display: none; justify-content: center; gap: 40px; z-index: 10; }
        .btn { width: 80px; height: 80px; background: rgba(255,255,255,0.85); border: 3px solid #333; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 28px; color: #333; font-weight: bold; }
    </style>
</head>
<body>

    <div id="menu">
        <h1>STEVE PARKOUR</h1>
        <div id="highScoreText">RECORDE: 0m</div>
        <div style="flex-grow: 1;"></div> 
        <div style="display:flex; flex-direction:column; gap:12px;">
            <div class="menu-btn" onclick="startGame()">JOGAR</div>
            <div class="menu-btn blue" onclick="resetScore()">LIMPAR RECORDE</div>
        </div>
    </div>

    <div id="ui"><b>DISTÂNCIA: <span id="dist">0</span>m</b></div>

    <div class="controls" id="gameControls">
        <div class="btn" id="left">←</div>
        <div class="btn" id="right">→</div>
        <div class="btn" id="jump" style="width:120px; border-radius:40px;">PULO</div>
    </div>

    <canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
let cameraX = 0, world = {}, lastGeneratedX = 0, gameActive = false;

// Tamanho original de antes (w:32, h:56)
const player = { x: 80, y: 350, w: 32, h: 56, vx: 0, vy: 0, speed: 4.4, jump: -14, onGround: false, animStep: 0 };

function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
window.onresize = resize; resize();

function updateScoreDisplay() {
    let record = localStorage.getItem("highScore") || 0;
    document.getElementById("highScoreText").innerText = "MELHOR MARCA: " + record + "m";
}
updateScoreDisplay();

function startGame() {
    document.getElementById("menu").style.display = "none";
    document.getElementById("ui").style.display = "block";
    document.getElementById("gameControls").style.display = "flex";
    world = {}; lastGeneratedX = 0; player.x = 80; player.y = 350; player.vx = 0; player.vy = 0; cameraX = 0;
    for(let i=0; i<6; i++) world[`${i*50},450`] = "grass";
    expandWorld(300);
    gameActive = true;
}

function stopGame() {
    gameActive = false;
    document.getElementById("menu").style.display = "flex";
    document.getElementById("ui").style.display = "none";
    document.getElementById("gameControls").style.display = "none";
    updateScoreDisplay();
}

function resetScore() {
    if(confirm("Reiniciar recorde?")) { localStorage.setItem("highScore", 0); updateScoreDisplay(); }
}

function expandWorld(startX) {
    let x = startX;
    let y = 450;
    for(let i = 0; i < 15; i++) {
        x += 140 + Math.random() * 60;
        y += (Math.random() - 0.5) * 170;
        y = Math.max(250, Math.min(canvas.height - 150, y));
        let gx = Math.floor(x/50)*50;
        let gy = Math.floor(y/50)*50;
        let types = ["stone", "brick", "dirt"];
        world[`${gx},${gy}`] = types[Math.floor(Math.random()*types.length)];
    }
    lastGeneratedX = x;
}

const input = { left: false, right: false, jump: false };
const bind = (id, k) => {
    const el = document.getElementById(id);
    el.addEventListener('touchstart', (e) => { e.preventDefault(); input[k] = true; });
    el.addEventListener('touchend', () => input[k] = false);
};
bind("left", "left"); bind("right", "right"); bind("jump", "jump");

function drawSteve(x, y, scale = 1, isMenu = false) {
    let sx = isMenu ? canvas.width/2 - (16*scale) : x - cameraX;
    let sy = isMenu ? canvas.height/2 - (40*scale) : y;
    let swing = Math.sin(isMenu ? Date.now()*0.003 : player.animStep) * 15;
    
    ctx.save();
    // No menu, o contorno é 3x mais grosso para ser mais visível
    ctx.lineWidth = isMenu ? 6 : 2; 
    ctx.strokeStyle = "black";
    
    // Braço Longe
    ctx.fillStyle = "#d3a395";
    ctx.fillRect(sx - (4*scale) - (swing*scale/4), sy+10*scale, 8*scale, 24*scale);
    ctx.strokeRect(sx-(4*scale) - (swing*scale/4), sy+10*scale, 8*scale, 24*scale);

    // Pernas
    ctx.fillStyle = "#3c44aa";
    ctx.fillRect(sx+4*scale, sy+34*scale, 12*scale, 20*scale); ctx.strokeRect(sx+4*scale, sy+34*scale, 12*scale, 20*scale);
    ctx.fillRect(sx+16*scale, sy+34*scale, 12*scale, 20*scale); ctx.strokeRect(sx+16*scale, sy+34*scale, 12*scale, 20*scale);
    
    // Tronco
    ctx.fillStyle = "#3aa0a2";
    ctx.fillRect(sx+4*scale, sy+10*scale, 24*scale, 24*scale); ctx.strokeRect(sx+4*scale, sy+10*scale, 24*scale, 24*scale);
    
    // Cabeça
    ctx.fillStyle = "#d3a395";
    ctx.fillRect(sx+4*scale, sy-14*scale, 24*scale, 24*scale); ctx.strokeRect(sx+4*scale, sy-14*scale, 24*scale, 24*scale);
    ctx.fillStyle = "#5d3a1a"; ctx.fillRect(sx+4*scale, sy-14*scale, 24*scale, 6*scale);
    ctx.fillStyle = "white"; 
    ctx.fillRect(sx+6*scale, sy-2*scale, 6*scale, 4*scale); ctx.fillRect(sx+20*scale, sy-2*scale, 6*scale, 4*scale);
    
    // Braço Perto
    ctx.fillStyle = "#d3a395";
    ctx.fillRect(sx+(28*scale) + (swing*scale/4), sy+10*scale, 8*scale, 24*scale);
    ctx.strokeRect(sx+(28*scale) + (swing*scale/4), sy+10*scale, 8*scale, 24*scale);

    ctx.restore();
}

function drawBlock(x, y, type) {
    let sx = x - cameraX;
    ctx.save();
    if(type === "grass") {
        ctx.fillStyle = "#5d4037"; ctx.fillRect(sx, y, 50, 50); // Terra
        ctx.fillStyle = "#4caf50"; ctx.fillRect(sx, y, 50, 14); // Topo Grama
        ctx.fillStyle = "#388e3c"; ctx.fillRect(sx, y+10, 50, 4); // Sombra
    } else if(type === "stone") {
        ctx.fillStyle = "#757575"; ctx.fillRect(sx, y, 50, 50);
        ctx.fillStyle = "#9e9e9e"; ctx.fillRect(sx+3, y+3, 44, 44);
        ctx.fillStyle = "#616161"; ctx.fillRect(sx+8, y+8, 8, 2); 
    } else {
        ctx.fillStyle = "#a54331"; ctx.fillRect(sx, y, 50, 50);
        ctx.strokeStyle = "rgba(0,0,0,0.1)"; ctx.strokeRect(sx+4, y+4, 42, 42);
    }
    ctx.restore();
}

function update() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    if (!gameActive) {
        // No menu: escala 3.5x e cores vivas
        drawSteve(0, 0, 3.5, true); 
        requestAnimationFrame(update); return;
    }

    if (input.left) { player.vx = -player.speed; player.animStep += 0.2; }
    else if (input.right) { player.vx = player.speed; player.animStep += 0.2; }
    else { player.vx *= 0.8; player.animStep = 0; }

    player.x += player.vx; player.vy += 0.7; player.y += player.vy;
    let gx = Math.floor((player.x+16)/50)*50, gy = Math.floor((player.y+player.h)/50)*50;
    if(world[`${gx},${gy}`]) { player.y = gy - player.h; player.vy = 0; player.onGround = true; } 
    else player.onGround = false;

    if(input.jump && player.onGround) { player.vy = player.jump; player.onGround = false; }
    
    if(player.y > canvas.height + 100) {
        let dist = Math.floor(player.x / 50);
        if(dist > (localStorage.getItem("highScore")||0)) localStorage.setItem("highScore", dist);
        stopGame();
    }

    if (player.x + 1000 > lastGeneratedX) expandWorld(lastGeneratedX);
    cameraX += (player.x - canvas.width/3 - cameraX) * 0.1;
    document.getElementById("dist").innerText = Math.floor(player.x / 50);

    for (let pos in world) {
        let [bx, by] = pos.split(",").map(Number);
        if (bx > cameraX - 50 && bx < cameraX + canvas.width) drawBlock(bx, by, world[pos]);
    }
    // No jogo: escala 1 (tamanho original)
    drawSteve(player.x, player.y, 1, false);
    requestAnimationFrame(update);
}
update();
</script>
</body>
</html>
