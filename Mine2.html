<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Steve Parkour Herobrine</title>
    <style>
        body { margin: 0; overflow: hidden; background: #9db9eb; font-family: 'Arial', sans-serif; touch-action: none; }
        canvas { display: block; }
        
        /* Menu Estilizado */
        #menu { 
            position: absolute; inset: 0; background: #9db9eb; 
            display: flex; flex-direction: column; align-items: center; justify-content: center; 
            z-index: 200; text-align: center;
        }
        .btn-start { 
            padding: 20px 60px; background: #4caf50; color: white; border: none; 
            border-bottom: 6px solid #2e7d32; font-size: 26px; font-weight: bold; 
            border-radius: 12px; cursor: pointer; margin-top: 20px;
        }
        #nameInput { 
            padding: 15px; font-size: 18px; border-radius: 8px; border: 3px solid #333; 
            width: 250px; text-align: center; 
        }

        #ui { position: absolute; top: 10px; left: 10px; background: rgba(0,0,0,0.6); color: white; padding: 12px; border-radius: 8px; z-index: 100; display: none; }

        /* Controles Mobile */
        .controls { position: absolute; bottom: 30px; width: 100%; display: none; justify-content: space-between; padding: 0 30px; box-sizing: border-box; z-index: 150; }
        .ctrl-btn { width: 80px; height: 80px; background: rgba(255,255,255,0.4); border: 3px solid #333; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 32px; font-weight: bold; user-select: none; }
    </style>
</head>
<body>

    <div id="menu">
        <h1 style="color:white; text-shadow: 4px 4px #000; font-size: 45px; margin-bottom: 10px;">STEVE PARKOUR</h1>
        <p style="color: white; font-weight: bold;">DESAFIO 1000 METROS</p>
        <input type="text" id="nameInput" placeholder="Teu nome..." maxlength="12">
        <button class="btn-start" onclick="initGame()">COMEÇAR JOGO</button>
        <p style="color: #555; font-size: 14px; margin-top: 15px;">PC: SETAS e ESPAÇO | Celular: BOTÕES</p>
    </div>

    <div id="ui">
        <b>JOGADOR: <span id="displayName">Steve</span></b><br>
        <b>DISTÂNCIA: <span id="dist">0</span>/1000m</b>
    </div>

    <div class="controls" id="mobileControls">
        <div style="display: flex; gap: 20px;">
            <div class="ctrl-btn" id="btnLeft">←</div>
            <div class="ctrl-btn" id="btnRight">→</div>
        </div>
        <div class="ctrl-btn" id="btnJump" style="width: 130px; border-radius: 40px;">PULO</div>
    </div>

    <canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
let gameRunning = false;
let world = {};
let cameraX = 0;
let lastX = 0;

// Gravidades pedidas: 7 (subida) e 8 (queda)
const GRAV_UP = 0.7; 
const GRAV_DOWN = 0.8;  
const JUMP = -16;

const player = { x: 100, y: 0, w: 30, h: 55, vx: 0, vy: 0, onGround: false, speed: 6 };
const input = { left: false, right: false };

function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
window.addEventListener('resize', resize);
resize();

// --- Geração do Parkour ---
function generateBlocks(startX, count) {
    let x = startX;
    for(let i = 0; i < count; i++) {
        // Espaçamento entre blocos (ajustado para gravidade 7/8)
        x += 160 + Math.random() * 80;
        // Altura aleatória
        let y = (canvas.height * 0.4) + Math.random() * (canvas.height * 0.3);
        let pos = `${Math.floor(x/50)*50},${Math.floor(y/50)*50}`;
        world[pos] = "grass";
        lastX = x;
    }
}

function initGame() {
    const name = document.getElementById("nameInput").value.trim() || "Steve";
    document.getElementById("displayName").innerText = name;
    document.getElementById("menu").style.display = "none";
    document.getElementById("ui").style.display = "block";
    
    if ('ontouchstart' in window) {
        document.getElementById("mobileControls").style.display = "flex";
    }

    // Reset de jogo
    world = {};
    cameraX = 0;
    player.x = 100;
    player.y = canvas.height / 2;
    player.vy = 0;
    
    // Plataforma inicial para não cair direto
    for(let i=0; i<8; i++) {
        world[`${i*50},${Math.floor(canvas.height*0.7/50)*50}`] = "grass";
    }
    
    generateBlocks(400, 20);
    gameRunning = true;
    requestAnimationFrame(loop);
}

// --- Comandos PC ---
window.addEventListener("keydown", (e) => {
    if(e.code === "ArrowLeft" || e.code === "KeyA") input.left = true;
    if(e.code === "ArrowRight" || e.code === "KeyD") input.right = true;
    if((e.code === "Space" || e.code === "ArrowUp") && player.onGround) player.vy = JUMP;
});
window.addEventListener("keyup", (e) => {
    if(e.code === "ArrowLeft" || e.code === "KeyA") input.left = false;
    if(e.code === "ArrowRight" || e.code === "KeyD") input.right = false;
});

// --- Comandos Touch ---
const touch = (id, key) => {
    const el = document.getElementById(id);
    el.addEventListener("touchstart", (e) => { e.preventDefault(); if(key) input[key] = true; else if(player.onGround) player.vy = JUMP; });
    el.addEventListener("touchend", (e) => { if(key) input[key] = false; });
};
touch("btnLeft", "left"); touch("btnRight", "right"); touch("btnJump", null);

function loop() {
    if(!gameRunning) return;

    // Física de movimento
    if(input.left) player.vx = -player.speed;
    else if(input.right) player.vx = player.speed;
    else player.vx *= 0.8;

    // Aplicação das gravidades 7 e 8
    player.vy += (player.vy < 0) ? GRAV_UP : GRAV_DOWN;

    player.x += player.vx;
    player.y += player.vy;

    // Colisão simplificada
    player.onGround = false;
    for(let pos in world) {
        let [bx, by] = pos.split(",").map(Number);
        if(player.x + player.w > bx && player.x < bx + 50 &&
           player.y + player.h > by && player.y + player.h < by + 20) {
            if(player.vy > 0) { // Só colide vindo de cima
                player.y = by - player.h;
                player.vy = 0;
                player.onGround = true;
            }
        }
    }

    // Cair no buraco
    if(player.y > canvas.height + 100) {
        gameRunning = false;
        alert("Fim de Jogo! Tente novamente.");
        location.reload();
    }

    // Câmera segue o jogador
    cameraX += (player.x - canvas.width/3 - cameraX) * 0.1;

    // Gerar mais parkour conforme avança (Infinito)
    if(player.x > lastX - 1000) generateBlocks(lastX, 10);

    // Desenho
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // Desenhar blocos
    for(let pos in world) {
        let [bx, by] = pos.split(",").map(Number);
        if(bx > cameraX - 100 && bx < cameraX + canvas.width) {
            ctx.fillStyle = "#795548"; // Terra
            ctx.fillRect(bx - cameraX, by, 50, 50);
            ctx.fillStyle = "#4caf50"; // Grama
            ctx.fillRect(bx - cameraX, by, 50, 15);
        }
    }

    // Desenhar Steve Herobrine
    let sx = player.x - cameraX;
    ctx.fillStyle = "#3aa0a2"; ctx.fillRect(sx, player.y + 15, player.w, 25); // Camisa
    ctx.fillStyle = "#d3a395"; ctx.fillRect(sx + 2, player.y, player.w - 4, 20); // Cabeça
    ctx.fillStyle = "white"; // Olhos Herobrine
    ctx.fillRect(sx + 5, player.y + 7, 6, 4);
    ctx.fillRect(sx + 19, player.y + 7, 6, 4);

    document.getElementById("dist").innerText = Math.floor(player.x/50);
    requestAnimationFrame(loop);
}
</script>
</body>
</html>
